"""
–ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–º–∏ –æ–∫—Ä—É–≥–∞–º–∏ –∏ —Ä–µ–≥–∏–æ–Ω–∞–º–∏ –†–æ—Å—Å–∏–∏.

–§—É–Ω–∫—Ü–∏–∏:
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –§–û –∏ —Ä–µ–≥–∏–æ–Ω–æ–≤ (–≤—Å–µ 85 —Å—É–±—ä–µ–∫—Ç–æ–≤)
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–≥–∏–æ–Ω–æ–≤ (normalize_region)
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ –ø–æ –ò–ù–ù (region_from_inn)
- Fuzzy matching –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–æ–≤
- –ü–∞—Ä—Å–∏–Ω–≥ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
"""

from typing import List, Dict, Tuple, Optional
from difflib import get_close_matches
import re
import logging

logger = logging.getLogger(__name__)


# –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –æ–∫—Ä—É–≥–∞ –†–æ—Å—Å–∏–∏ —Å —Ä–µ–≥–∏–æ–Ω–∞–º–∏
FEDERAL_DISTRICTS = {
    "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π": {
        "code": "–¶–§–û",
        "regions": [
            "–ú–æ—Å–∫–≤–∞",
            "–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ë—Ä—è–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ò–≤–∞–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ö–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ö—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–õ–∏–ø–µ—Ü–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–û—Ä–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–†—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–°–º–æ–ª–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–¢–∞–º–±–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–¢–≤–µ—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–¢—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å"
        ]
    },
    "–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π": {
        "code": "–°–ó–§–û",
        "regions": [
            "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
            "–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–í–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞—Ä–µ–ª–∏—è",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–æ–º–∏",
            "–ú—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ù–µ–Ω–µ—Ü–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥",
            "–ù–æ–≤–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ü—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å"
        ]
    },
    "–Æ–∂–Ω—ã–π": {
        "code": "–Æ–§–û",
        "regions": [
            "–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ê–¥—ã–≥–µ—è",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞–ª–º—ã–∫–∏—è",
            "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö—Ä—ã–º",
            "–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å"
        ]
    },
    "–°–µ–≤–µ—Ä–æ-–ö–∞–≤–∫–∞–∑—Å–∫–∏–π": {
        "code": "–°–ö–§–û",
        "regions": [
            "–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –î–∞–≥–µ—Å—Ç–∞–Ω",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ò–Ω–≥—É—à–µ—Ç–∏—è",
            "–ö–∞–±–∞—Ä–¥–∏–Ω–æ-–ë–∞–ª–∫–∞—Ä—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞",
            "–ö–∞—Ä–∞—á–∞–µ–≤–æ-–ß–µ—Ä–∫–µ—Å—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–µ–≤–µ—Ä–Ω–∞—è –û—Å–µ—Ç–∏—è ‚Äî –ê–ª–∞–Ω–∏—è",
            "–ß–µ—á–µ–Ω—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞"
        ]
    },
    "–ü—Ä–∏–≤–æ–ª–∂—Å–∫–∏–π": {
        "code": "–ü–§–û",
        "regions": [
            "–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ö–∏—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–°–∞–º–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ü–µ–Ω–∑–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ü–µ—Ä–º—Å–∫–∏–π –∫—Ä–∞–π",
            "–°–∞—Ä–∞—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–£–ª—å—è–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ú–∞—Ä–∏–π –≠–ª",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ú–æ—Ä–¥–æ–≤–∏—è",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω",
            "–£–¥–º—É—Ä—Ç—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞",
            "–ß—É–≤–∞—à—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞"
        ]
    },
    "–£—Ä–∞–ª—å—Å–∫–∏–π": {
        "code": "–£–§–û",
        "regions": [
            "–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ß–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ö—É—Ä–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–¢—é–º–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–•–∞–Ω—Ç—ã-–ú–∞–Ω—Å–∏–π—Å–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥ ‚Äî –Æ–≥—Ä–∞",
            "–Ø–º–∞–ª–æ-–ù–µ–Ω–µ—Ü–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥"
        ]
    },
    "–°–∏–±–∏—Ä—Å–∫–∏–π": {
        "code": "–°–§–û",
        "regions": [
            "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ê–ª—Ç–∞–π",
            "–ò—Ä–∫—É—Ç—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ö–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π –∫—Ä–∞–π",
            "–û–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–¢–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢—ã–≤–∞",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –•–∞–∫–∞—Å–∏—è"
        ]
    },
    "–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–π": {
        "code": "–î–§–û",
        "regions": [
            "–•–∞–±–∞—Ä–æ–≤—Å–∫–∏–π –∫—Ä–∞–π",
            "–ü—Ä–∏–º–æ—Ä—Å–∫–∏–π –∫—Ä–∞–π",
            "–ê–º—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ö–∞–º—á–∞—Ç—Å–∫–∏–π –∫—Ä–∞–π",
            "–ú–∞–≥–∞–¥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–°–∞—Ö–∞–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–∞—Ö–∞ (–Ø–∫—É—Ç–∏—è)",
            "–ï–≤—Ä–µ–π—Å–∫–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è –æ–±–ª–∞—Å—Ç—å",
            "–ß—É–∫–æ—Ç—Å–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥",
            "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë—É—Ä—è—Ç–∏—è",
            "–ó–∞–±–∞–π–∫–∞–ª—å—Å–∫–∏–π –∫—Ä–∞–π"
        ]
    }
}


# –°–æ–∑–¥–∞–µ–º –æ–±—Ä–∞—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å: —Ä–µ–≥–∏–æ–Ω -> —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –æ–∫—Ä—É–≥
REGION_TO_DISTRICT = {}
ALL_REGIONS = []
for district_name, district_data in FEDERAL_DISTRICTS.items():
    for region in district_data["regions"]:
        REGION_TO_DISTRICT[region.lower()] = district_name
        ALL_REGIONS.append(region)


# –°–ª–æ–≤–∞—Ä—å —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π, –≤—Å–µ 85 —Å—É–±—ä–µ–∫—Ç–æ–≤)
REGION_ALIASES = {
    # –ì–æ—Ä–æ–¥–∞ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
    "–º–æ—Å–∫–≤–∞": ["–º—Å–∫", "moscow", "–≥. –º–æ—Å–∫–≤–∞", "–≥–æ—Ä–æ–¥ –º–æ—Å–∫–≤–∞", "–≥.–º–æ—Å–∫–≤–∞"],
    "—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥": ["—Å–ø–±", "–ø–µ—Ç–µ—Ä–±—É—Ä–≥", "–ø–∏—Ç–µ—Ä", "—Å–∞–Ω–∫—Ç –ø–µ—Ç–µ—Ä–±—É—Ä–≥", "–ª–µ–Ω–∏–Ω–≥—Ä–∞–¥", "–≥. —Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥", "—Å-–ø–µ—Ç–µ—Ä–±—É—Ä–≥", "—Å.-–ø–µ—Ç–µ—Ä–±—É—Ä–≥"],
    "—Å–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å": ["–≥. —Å–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å", "–≥–æ—Ä–æ–¥ —Å–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å"],
    # –û–±–ª–∞—Å—Ç–∏ ‚Äî –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –§–û
    "–º–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–ø–æ–¥–º–æ—Å–∫–æ–≤—å–µ", "–º–æ", "–º–æ—Å–∫–æ–≤ –æ–±–ª", "–º–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª", "–º–æ—Å–∫–æ–≤. –æ–±–ª"],
    "–±–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–±–µ–ª–≥–æ—Ä–æ–¥", "–±–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª"],
    "–±—Ä—è–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–±—Ä—è–Ω—Å–∫", "–±—Ä—è–Ω—Å–∫–∞—è –æ–±–ª"],
    "–≤–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–≤–ª–∞–¥–∏–º–∏—Ä", "–≤–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª"],
    "–≤–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–≤–æ—Ä–æ–Ω–µ–∂", "–≤–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª"],
    "–∏–≤–∞–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–∏–≤–∞–Ω–æ–≤–æ", "–∏–≤–∞–Ω–æ–≤—Å–∫–∞—è –æ–±–ª"],
    "–∫–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–∫–∞–ª—É–≥–∞", "–∫–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª"],
    "–∫–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–∫–æ—Å—Ç—Ä–æ–º–∞", "–∫–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è –æ–±–ª"],
    "–∫—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–∫—É—Ä—Å–∫", "–∫—É—Ä—Å–∫–∞—è –æ–±–ª"],
    "–ª–∏–ø–µ—Ü–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–ª–∏–ø–µ—Ü–∫", "–ª–∏–ø–µ—Ü–∫–∞—è –æ–±–ª"],
    "–æ—Ä–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–æ—Ä–µ–ª", "–æ—Ä—ë–ª", "–æ—Ä–ª–æ–≤—Å–∫–∞—è –æ–±–ª"],
    "—Ä—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—Ä—è–∑–∞–Ω—å", "—Ä—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª"],
    "—Å–º–æ–ª–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—Å–º–æ–ª–µ–Ω—Å–∫", "—Å–º–æ–ª–µ–Ω—Å–∫–∞—è –æ–±–ª"],
    "—Ç–∞–º–±–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—Ç–∞–º–±–æ–≤", "—Ç–∞–º–±–æ–≤—Å–∫–∞—è –æ–±–ª"],
    "—Ç–≤–µ—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—Ç–≤–µ—Ä—å", "—Ç–≤–µ—Ä—Å–∫–∞—è –æ–±–ª"],
    "—Ç—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—Ç—É–ª–∞", "—Ç—É–ª—å—Å–∫–∞—è –æ–±–ª"],
    "—è—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—è—Ä–æ—Å–ª–∞–≤–ª—å", "—è—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è –æ–±–ª"],
    # –°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π –§–û
    "–ª–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–ª–æ", "–ª–µ–Ω–æ–±–ª–∞—Å—Ç—å", "–ª–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª"],
    "–∞—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–∞—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫", "–∞—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª"],
    "–≤–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–≤–æ–ª–æ–≥–¥–∞", "–≤–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª"],
    "–∫–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–∫–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥", "–∫–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª"],
    "–º—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–º—É—Ä–º–∞–Ω—Å–∫", "–º—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª"],
    "–Ω–æ–≤–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–≤–µ–ª–∏–∫–∏–π –Ω–æ–≤–≥–æ—Ä–æ–¥", "–Ω–æ–≤–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª", "–Ω–æ–≤–≥–æ—Ä–æ–¥"],
    "–ø—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–ø—Å–∫–æ–≤", "–ø—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª"],
    # –Æ–∂–Ω—ã–π –§–û
    "—Ä–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—Ä–æ—Å—Ç–æ–≤", "—Ä–æ—Å—Ç–æ–≤-–Ω–∞-–¥–æ–Ω—É", "—Ä–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª"],
    "–∞—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–∞—Å—Ç—Ä–∞—Ö–∞–Ω—å", "–∞—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª"],
    "–≤–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–≤–æ–ª–≥–æ–≥—Ä–∞–¥", "–≤–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª"],
    # –ü—Ä–∏–≤–æ–ª–∂—Å–∫–∏–π –§–û
    "–Ω–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–Ω–∏–∂–Ω–∏–π –Ω–æ–≤–≥–æ—Ä–æ–¥", "–Ω–∏–∂–Ω–∏–π", "–Ω–Ω–æ–≤", "–Ω–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª"],
    "–∫–∏—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–∫–∏—Ä–æ–≤", "–∫–∏—Ä–æ–≤—Å–∫–∞—è –æ–±–ª"],
    "—Å–∞–º–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—Å–∞–º–∞—Ä–∞", "—Å–∞–º–∞—Ä—Å–∫–∞—è –æ–±–ª"],
    "–æ—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–æ—Ä–µ–Ω–±—É—Ä–≥", "–æ—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è –æ–±–ª"],
    "–ø–µ–Ω–∑–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–ø–µ–Ω–∑–∞", "–ø–µ–Ω–∑–µ–Ω—Å–∫–∞—è –æ–±–ª"],
    "—Å–∞—Ä–∞—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—Å–∞—Ä–∞—Ç–æ–≤", "—Å–∞—Ä–∞—Ç–æ–≤—Å–∫–∞—è –æ–±–ª"],
    "—É–ª—å—è–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—É–ª—å—è–Ω–æ–≤—Å–∫", "—É–ª—å—è–Ω–æ–≤—Å–∫–∞—è –æ–±–ª"],
    # –£—Ä–∞–ª—å—Å–∫–∏–π –§–û
    "—Å–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥", "—Å–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª"],
    "—á–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—á–µ–ª—è–±–∏–Ω—Å–∫", "—á–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª"],
    "–∫—É—Ä–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–∫—É—Ä–≥–∞–Ω", "–∫—É—Ä–≥–∞–Ω—Å–∫–∞—è –æ–±–ª"],
    "—Ç—é–º–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—Ç—é–º–µ–Ω—å", "—Ç—é–º–µ–Ω—Å–∫–∞—è –æ–±–ª"],
    # –°–∏–±–∏—Ä—Å–∫–∏–π –§–û
    "–Ω–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–Ω–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫", "–Ω–æ–≤–æ—Å–∏–±", "–Ω–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª"],
    "–∫–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–∫—É–∑–±–∞—Å—Å", "–∫–µ–º–µ—Ä–æ–≤–æ", "–∫–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª", "–∫–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å ‚Äî –∫—É–∑–±–∞—Å—Å"],
    "–∏—Ä–∫—É—Ç—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–∏—Ä–∫—É—Ç—Å–∫", "–∏—Ä–∫—É—Ç—Å–∫–∞—è –æ–±–ª"],
    "–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–æ–º—Å–∫", "–æ–º—Å–∫–∞—è –æ–±–ª"],
    "—Ç–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—Ç–æ–º—Å–∫", "—Ç–æ–º—Å–∫–∞—è –æ–±–ª"],
    # –î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–π –§–û
    "–∞–º—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–±–ª–∞–≥–æ–≤–µ—â–µ–Ω—Å–∫", "–∞–º—É—Ä—Å–∫–∞—è –æ–±–ª"],
    "–º–∞–≥–∞–¥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["–º–∞–≥–∞–¥–∞–Ω", "–º–∞–≥–∞–¥–∞–Ω—Å–∫–∞—è –æ–±–ª"],
    "—Å–∞—Ö–∞–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å": ["—Å–∞—Ö–∞–ª–∏–Ω", "—é–∂–Ω–æ-—Å–∞—Ö–∞–ª–∏–Ω—Å–∫", "—Å–∞—Ö–∞–ª–∏–Ω—Å–∫–∞—è –æ–±–ª"],
    # –ö—Ä–∞—è
    "–∫—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π": ["–∫—É–±–∞–Ω—å", "–∫—Ä–∞—Å–Ω–æ–¥–∞—Ä"],
    "—Å—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π": ["—Å—Ç–∞–≤—Ä–æ–ø–æ–ª—å"],
    "–ø–µ—Ä–º—Å–∫–∏–π –∫—Ä–∞–π": ["–ø–µ—Ä–º—å"],
    "–∫—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π –∫—Ä–∞–π": ["–∫—Ä–∞—Å–Ω–æ—è—Ä—Å–∫"],
    "—Ö–∞–±–∞—Ä–æ–≤—Å–∫–∏–π –∫—Ä–∞–π": ["—Ö–∞–±–∞—Ä–æ–≤—Å–∫"],
    "–ø—Ä–∏–º–æ—Ä—Å–∫–∏–π –∫—Ä–∞–π": ["–≤–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫", "–ø—Ä–∏–º–æ—Ä"],
    "–∞–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π": ["–±–∞—Ä–Ω–∞—É–ª"],
    "–∫–∞–º—á–∞—Ç—Å–∫–∏–π –∫—Ä–∞–π": ["–∫–∞–º—á–∞—Ç–∫–∞", "–ø–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫-–∫–∞–º—á–∞—Ç—Å–∫–∏–π"],
    "–∑–∞–±–∞–π–∫–∞–ª—å—Å–∫–∏–π –∫—Ä–∞–π": ["—á–∏—Ç–∞", "–∑–∞–±–∞–π–∫–∞–ª—å–µ"],
    # –†–µ—Å–ø—É–±–ª–∏–∫–∏
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –∞–¥—ã–≥–µ—è": ["–∞–¥—ã–≥–µ—è", "–∞–¥—ã–≥–µ–π—Å–∫–∞—è", "–º–∞–π–∫–æ–ø"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –∫–∞–ª–º—ã–∫–∏—è": ["–∫–∞–ª–º—ã–∫–∏—è", "—ç–ª–∏—Å—Ç–∞"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –∫—Ä—ã–º": ["–∫—Ä—ã–º"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –¥–∞–≥–µ—Å—Ç–∞–Ω": ["–¥–∞–≥–µ—Å—Ç–∞–Ω", "–º–∞—Ö–∞—á–∫–∞–ª–∞"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –∏–Ω–≥—É—à–µ—Ç–∏—è": ["–∏–Ω–≥—É—à–µ—Ç–∏—è", "–º–∞–≥–∞—Å", "–Ω–∞–∑—Ä–∞–Ω—å"],
    "–∫–∞–±–∞—Ä–¥–∏–Ω–æ-–±–∞–ª–∫–∞—Ä—Å–∫–∞—è —Ä–µ—Å–ø—É–±–ª–∏–∫–∞": ["–∫–∞–±–∞—Ä–¥–∏–Ω–æ-–±–∞–ª–∫–∞—Ä–∏—è", "–∫–±—Ä", "–Ω–∞–ª—å—á–∏–∫"],
    "–∫–∞—Ä–∞—á–∞–µ–≤–æ-—á–µ—Ä–∫–µ—Å—Å–∫–∞—è —Ä–µ—Å–ø—É–±–ª–∏–∫–∞": ["–∫–∞—Ä–∞—á–∞–µ–≤–æ-—á–µ—Ä–∫–µ—Å–∏—è", "–∫—á—Ä", "—á–µ—Ä–∫–µ—Å—Å–∫"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ —Å–µ–≤–µ—Ä–Ω–∞—è –æ—Å–µ—Ç–∏—è ‚Äî –∞–ª–∞–Ω–∏—è": ["—Å–µ–≤–µ—Ä–Ω–∞—è –æ—Å–µ—Ç–∏—è", "–æ—Å–µ—Ç–∏—è", "–≤–ª–∞–¥–∏–∫–∞–≤–∫–∞–∑", "–∞–ª–∞–Ω–∏—è"],
    "—á–µ—á–µ–Ω—Å–∫–∞—è —Ä–µ—Å–ø—É–±–ª–∏–∫–∞": ["—á–µ—á–Ω—è", "–≥—Ä–æ–∑–Ω—ã–π"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –±–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω": ["–±–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω", "–±–∞—à–∫–∏—Ä–∏—è", "—É—Ñ–∞"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –º–∞—Ä–∏–π —ç–ª": ["–º–∞—Ä–∏–π —ç–ª", "–π–æ—à–∫–∞—Ä-–æ–ª–∞"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –º–æ—Ä–¥–æ–≤–∏—è": ["–º–æ—Ä–¥–æ–≤–∏—è", "—Å–∞—Ä–∞–Ω—Å–∫"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ —Ç–∞—Ç–∞—Ä—Å—Ç–∞–Ω": ["—Ç–∞—Ç–∞—Ä—Å—Ç–∞–Ω", "–∫–∞–∑–∞–Ω—å"],
    "—É–¥–º—É—Ä—Ç—Å–∫–∞—è —Ä–µ—Å–ø—É–±–ª–∏–∫–∞": ["—É–¥–º—É—Ä—Ç–∏—è", "–∏–∂–µ–≤—Å–∫"],
    "—á—É–≤–∞—à—Å–∫–∞—è —Ä–µ—Å–ø—É–±–ª–∏–∫–∞": ["—á—É–≤–∞—à–∏—è", "—á–µ–±–æ–∫—Å–∞—Ä—ã"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –∫–∞—Ä–µ–ª–∏—è": ["–∫–∞—Ä–µ–ª–∏—è", "–ø–µ—Ç—Ä–æ–∑–∞–≤–æ–¥—Å–∫"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –∫–æ–º–∏": ["–∫–æ–º–∏", "—Å—ã–∫—Ç—ã–≤–∫–∞—Ä"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –∞–ª—Ç–∞–π": ["–≥–æ—Ä–Ω—ã–π –∞–ª—Ç–∞–π", "–≥–æ—Ä–Ω–æ-–∞–ª—Ç–∞–π—Å–∫"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ —Ç—ã–≤–∞": ["—Ç—ã–≤–∞", "—Ç—É–≤–∞", "–∫—ã–∑—ã–ª"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ —Ö–∞–∫–∞—Å–∏—è": ["—Ö–∞–∫–∞—Å–∏—è", "–∞–±–∞–∫–∞–Ω"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –±—É—Ä—è—Ç–∏—è": ["–±—É—Ä—è—Ç–∏—è", "—É–ª–∞–Ω-—É–¥—ç"],
    "—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ —Å–∞—Ö–∞ (—è–∫—É—Ç–∏—è)": ["—è–∫—É—Ç–∏—è", "—è–∫—É—Ç—Å–∫", "—Å–∞—Ö–∞"],
    # –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–µ –æ–∫—Ä—É–≥–∞
    "–Ω–µ–Ω–µ—Ü–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥": ["–Ω–∞–æ", "–Ω–∞—Ä—å—è–Ω-–º–∞—Ä"],
    "—Ö–∞–Ω—Ç—ã-–º–∞–Ω—Å–∏–π—Å–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥ ‚Äî —é–≥—Ä–∞": ["—Ö–º–∞–æ", "—é–≥—Ä–∞", "—Ö–∞–Ω—Ç—ã-–º–∞–Ω—Å–∏–π—Å–∫"],
    "—è–º–∞–ª–æ-–Ω–µ–Ω–µ—Ü–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥": ["—è–Ω–∞–æ", "—è–º–∞–ª", "—Å–∞–ª–µ—Ö–∞—Ä–¥"],
    "—á—É–∫–æ—Ç—Å–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥": ["—á—É–∫–æ—Ç–∫–∞", "—á–∞–æ", "–∞–Ω–∞–¥—ã—Ä—å"],
    # –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è –æ–±–ª–∞—Å—Ç—å
    "–µ–≤—Ä–µ–π—Å–∫–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è –æ–±–ª–∞—Å—Ç—å": ["–µ–∞–æ", "–±–∏—Ä–æ–±–∏–¥–∂–∞–Ω"],
}

# –°–æ–∑–¥–∞–µ–º –æ–±—Ä–∞—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å: –∞–ª–∏–∞—Å -> –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
ALIAS_TO_REGION = {}
for official_name, aliases in REGION_ALIASES.items():
    for alias in aliases:
        ALIAS_TO_REGION[alias.lower()] = official_name

# –ú–∞–ø–ø–∏–Ω–≥ –ø–µ—Ä–≤—ã—Ö 2 —Ü–∏—Ñ—Ä –ò–ù–ù ‚Üí —Ä–µ–≥–∏–æ–Ω (–∫–æ–¥—ã –ò–§–ù–°)
INN_REGION_MAP = {
    "01": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ê–¥—ã–≥–µ—è",
    "02": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω",
    "03": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë—É—Ä—è—Ç–∏—è",
    "04": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ê–ª—Ç–∞–π",
    "05": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –î–∞–≥–µ—Å—Ç–∞–Ω",
    "06": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ò–Ω–≥—É—à–µ—Ç–∏—è",
    "07": "–ö–∞–±–∞—Ä–¥–∏–Ω–æ-–ë–∞–ª–∫–∞—Ä—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞",
    "08": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞–ª–º—ã–∫–∏—è",
    "09": "–ö–∞—Ä–∞—á–∞–µ–≤–æ-–ß–µ—Ä–∫–µ—Å—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞",
    "10": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞—Ä–µ–ª–∏—è",
    "11": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–æ–º–∏",
    "12": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ú–∞—Ä–∏–π –≠–ª",
    "13": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ú–æ—Ä–¥–æ–≤–∏—è",
    "14": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–∞—Ö–∞ (–Ø–∫—É—Ç–∏—è)",
    "15": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–µ–≤–µ—Ä–Ω–∞—è –û—Å–µ—Ç–∏—è ‚Äî –ê–ª–∞–Ω–∏—è",
    "16": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω",
    "17": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢—ã–≤–∞",
    "18": "–£–¥–º—É—Ä—Ç—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞",
    "19": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –•–∞–∫–∞—Å–∏—è",
    "20": "–ß–µ—á–µ–Ω—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞",
    "21": "–ß—É–≤–∞—à—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞",
    "22": "–ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π",
    "23": "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π",
    "24": "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π –∫—Ä–∞–π",
    "25": "–ü—Ä–∏–º–æ—Ä—Å–∫–∏–π –∫—Ä–∞–π",
    "26": "–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π",
    "27": "–•–∞–±–∞—Ä–æ–≤—Å–∫–∏–π –∫—Ä–∞–π",
    "28": "–ê–º—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "29": "–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "30": "–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "31": "–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "32": "–ë—Ä—è–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "33": "–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "34": "–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "35": "–í–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "36": "–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "37": "–ò–≤–∞–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "38": "–ò—Ä–∫—É—Ç—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "39": "–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "40": "–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "41": "–ö–∞–º—á–∞—Ç—Å–∫–∏–π –∫—Ä–∞–π",
    "42": "–ö–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "43": "–ö–∏—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "44": "–ö–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "45": "–ö—É—Ä–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "46": "–ö—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "47": "–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "48": "–õ–∏–ø–µ—Ü–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "49": "–ú–∞–≥–∞–¥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "50": "–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "51": "–ú—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "52": "–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "53": "–ù–æ–≤–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "54": "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "55": "–û–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "56": "–û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "57": "–û—Ä–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "58": "–ü–µ–Ω–∑–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "59": "–ü–µ—Ä–º—Å–∫–∏–π –∫—Ä–∞–π",
    "60": "–ü—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "61": "–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "62": "–†—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "63": "–°–∞–º–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "64": "–°–∞—Ä–∞—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "65": "–°–∞—Ö–∞–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "66": "–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "67": "–°–º–æ–ª–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "68": "–¢–∞–º–±–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "69": "–¢–≤–µ—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "70": "–¢–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "71": "–¢—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "72": "–¢—é–º–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "73": "–£–ª—å—è–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "74": "–ß–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "75": "–ó–∞–±–∞–π–∫–∞–ª—å—Å–∫–∏–π –∫—Ä–∞–π",
    "76": "–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    "77": "–ú–æ—Å–∫–≤–∞",
    "78": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
    "79": "–ï–≤—Ä–µ–π—Å–∫–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è –æ–±–ª–∞—Å—Ç—å",
    "83": "–ù–µ–Ω–µ—Ü–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥",
    "86": "–•–∞–Ω—Ç—ã-–ú–∞–Ω—Å–∏–π—Å–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥ ‚Äî –Æ–≥—Ä–∞",
    "87": "–Ø–º–∞–ª–æ-–ù–µ–Ω–µ—Ü–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥",
    "89": "–ß—É–∫–æ—Ç—Å–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥",
    "91": "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö—Ä—ã–º",
    "92": "–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å",
    "99": "–ú–æ—Å–∫–≤–∞",  # –ë–∞–π–∫–æ–Ω—É—Ä ‚Üí –ø—Ä–∏—Ä–∞–≤–Ω–µ–Ω –∫ –ú–æ—Å–∫–≤–µ
}

# –ü–∞—Ç—Ç–µ—Ä–Ω—ã –º—É—Å–æ—Ä–∞ –≤ –∏–∑–≤–ª–µ—á—ë–Ω–Ω–æ–º —Ä–µ–≥–∏–æ–Ω–µ
_GARBAGE_PATTERNS = re.compile(
    r'(^–≥\.\s*.{1,2}$'     # "–≥. –∞", "–≥. –Ω–µ–≥–æ" (—Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–µ –≥–æ—Ä–æ–¥–∞)
    r'|^\s*—É–ª[\.\s]'         # –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å "—É–ª." / "—É–ª "
    r'|\b—É–ª–∏—Ü–∞\b'            # —Å–æ–¥–µ—Ä–∂–∏—Ç "—É–ª–∏—Ü–∞"
    r'|\b–ø–µ—Ä\.\b'            # "–ø–µ—Ä."
    r'|\b–ø—Ä–æ—Å–ø–µ–∫—Ç\b'         # "–ø—Ä–æ—Å–ø–µ–∫—Ç"
    r'|\b–ø—Ä-—Ç\b'             # "–ø—Ä-—Ç"
    r'|\b—à–æ—Å—Å–µ\b'            # "—à–æ—Å—Å–µ"
    r'|\b–Ω–∞–±–µ—Ä–µ–∂–Ω'           # "–Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è"
    r'|\b–±—É–ª—å–≤–∞—Ä\b'          # "–±—É–ª—å–≤–∞—Ä"
    r'|\b–ø–µ—Ä–µ—É–ª–æ–∫\b'         # "–ø–µ—Ä–µ—É–ª–æ–∫"
    r'|\b–º–∏–∫—Ä–æ—Ä–∞–π–æ–Ω\b'       # "–º–∏–∫—Ä–æ—Ä–∞–π–æ–Ω"
    r'|\b–ø–æ—Å—ë–ª–æ–∫\b|\b–ø–æ—Å–µ–ª–æ–∫\b'  # "–ø–æ—Å—ë–ª–æ–∫"
    r'|\bd{6}\b'             # 6-–∑–Ω–∞—á–Ω—ã–π –∏–Ω–¥–µ–∫—Å
    r')',
    re.IGNORECASE
)

# –ö–∞–Ω–æ–Ω–∏—á–Ω–æ–µ –∏–º—è (lowercase) ‚Üí –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ –∏–º—è (—Å —Ä–µ–≥–∏—Å—Ç—Ä–æ–º)
_CANONICAL_MAP: Dict[str, str] = {}
for _r in ALL_REGIONS:
    _CANONICAL_MAP[_r.lower()] = _r


def normalize_region(raw_text: str) -> Optional[str]:
    """
    –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–≤–ª–µ—á—ë–Ω–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞.

    –ü—Ä–∏–Ω–∏–º–∞–µ—Ç ¬´—Å—ã—Ä–æ–π¬ª —Ç–µ–∫—Å—Ç –∏–∑ enrichment –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–∞–Ω–æ–Ω–∏—á–Ω–æ–µ –∏–º—è —Ä–µ–≥–∏–æ–Ω–∞,
    –ª–∏–±–æ None –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç –º—É—Å–æ—Ä–Ω—ã–π –∏–ª–∏ –Ω–µ—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π.

    Args:
        raw_text: –°—ã—Ä–æ–π —Ç–µ–∫—Å—Ç —Ä–µ–≥–∏–æ–Ω–∞ –∏–∑ –ø–∞—Ä—Å–µ—Ä–∞

    Returns:
        –ö–∞–Ω–æ–Ω–∏—á–Ω–æ–µ –∏–º—è —Ä–µ–≥–∏–æ–Ω–∞ (–∫–∞–∫ –≤ FEDERAL_DISTRICTS) –∏–ª–∏ None
    """
    if not raw_text or len(raw_text.strip()) < 2:
        return None

    text = raw_text.strip()

    # –û—Ç—Å–µ–∫–∞–µ–º –º—É—Å–æ—Ä (—É–ª–∏—Ü—ã, –ø–µ—Ä–µ—É–ª–∫–∏, —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–µ –≥–æ—Ä–æ–¥–∞)
    if _GARBAGE_PATTERNS.search(text):
        logger.debug(f"Region garbage rejected: '{text}'")
        return None

    # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –¥–ª—è –ø–æ–∏—Å–∫–∞
    lower = text.lower().strip()

    # 1. –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å –∫–∞–Ω–æ–Ω–∏—á–Ω—ã–º –∏–º–µ–Ω–µ–º
    if lower in _CANONICAL_MAP:
        return _CANONICAL_MAP[lower]

    # 2. –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å –∞–ª–∏–∞—Å–æ–º
    if lower in ALIAS_TO_REGION:
        official_lower = ALIAS_TO_REGION[lower]
        if official_lower in _CANONICAL_MAP:
            return _CANONICAL_MAP[official_lower]

    # 3. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è: —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–µ–µ, –ø—Ä–æ–±—É–µ–º —Å–Ω–æ–≤–∞
    #    "–ö–†–ê–°–ù–û–î–ê–†–°–ö–ò–ô –ö–†–ê–ô" ‚Üí "–∫—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π"
    #    "–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª." ‚Üí "–º–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª"
    cleaned = re.sub(r'\s+', ' ', lower)
    cleaned = re.sub(r'\.$', '', cleaned)  # —É–±–∏—Ä–∞–µ–º —Ç–æ—á–∫—É –≤ –∫–æ–Ω—Ü–µ

    if cleaned in _CANONICAL_MAP:
        return _CANONICAL_MAP[cleaned]
    if cleaned in ALIAS_TO_REGION:
        official_lower = ALIAS_TO_REGION[cleaned]
        if official_lower in _CANONICAL_MAP:
            return _CANONICAL_MAP[official_lower]

    # 4. –ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫: "–ë—É—Ä—è—Ç–∏—è –†–µ—Å–ø—É–±–ª–∏–∫–∞" ‚Üí "–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë—É—Ä—è—Ç–∏—è"
    words = cleaned.split()
    if len(words) == 2:
        inverted = f"{words[1]} {words[0]}"
        if inverted in _CANONICAL_MAP:
            return _CANONICAL_MAP[inverted]
        if inverted in ALIAS_TO_REGION:
            official_lower = ALIAS_TO_REGION[inverted]
            if official_lower in _CANONICAL_MAP:
                return _CANONICAL_MAP[official_lower]

    # 5. –û—Ç—Å–µ—á–µ–Ω–∏–µ —Ä–∞–π–æ–Ω–∞: "–ß–ï–õ–Ø–ë–ò–ù–°–ö–ê–Ø –û–ë–õ–ê–°–¢–¨ –ö–û–†–ö–ò–ù–°–ö–ò–ô" ‚Üí "–ß–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å"
    #    –ò—â–µ–º —Å–∞–º—ã–π –¥–ª–∏–Ω–Ω—ã–π —Å–æ–≤–ø–∞–≤—à–∏–π —Ä–µ–≥–∏–æ–Ω –≤ —Ç–µ–∫—Å—Ç–µ
    best_match = None
    best_len = 0
    for canonical_lower, canonical_name in _CANONICAL_MAP.items():
        if canonical_lower in cleaned and len(canonical_lower) > best_len:
            best_match = canonical_name
            best_len = len(canonical_lower)

    if best_match:
        return best_match

    # 6. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–π –∞–ª–∏–∞—Å –∫–∞–∫ –ø–æ–¥—Å—Ç—Ä–æ–∫—É
    for alias_lower, official_lower in ALIAS_TO_REGION.items():
        # –¢–æ–ª—å–∫–æ –∞–ª–∏–∞—Å—ã >= 4 —Å–∏–º–≤–æ–ª–æ–≤ (–∏–Ω–∞—á–µ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ false positive)
        if len(alias_lower) >= 4 and alias_lower in cleaned:
            if official_lower in _CANONICAL_MAP:
                return _CANONICAL_MAP[official_lower]

    return None


def region_from_inn(inn: str) -> Optional[str]:
    """
    –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ –ø–æ –ò–ù–ù –∑–∞–∫–∞–∑—á–∏–∫–∞.
    –ü–µ—Ä–≤—ã–µ 2 —Ü–∏—Ñ—Ä—ã –ò–ù–ù = –∫–æ–¥ –ò–§–ù–° (—Ä–µ–≥–∏–æ–Ω).

    Args:
        inn: –ò–ù–ù (—Å—Ç—Ä–æ–∫–∞ 10 –∏–ª–∏ 12 —Å–∏–º–≤–æ–ª–æ–≤)

    Returns:
        –ö–∞–Ω–æ–Ω–∏—á–Ω–æ–µ –∏–º—è —Ä–µ–≥–∏–æ–Ω–∞ –∏–ª–∏ None
    """
    if not inn or not isinstance(inn, str):
        return None

    digits = inn.strip()
    if len(digits) not in (10, 12):
        return None
    if not digits.isdigit():
        return None

    code = digits[:2]
    return INN_REGION_MAP.get(code)


def normalize_region_name(region_input: str) -> str:
    """
    –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–∞ (lowercase, —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã).

    Args:
        region_input: –í—Ö–æ–¥–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞

    Returns:
        –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
    """
    # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ lowercase
    normalized = re.sub(r'\s+', ' ', region_input.strip()).lower()
    # –£–±–∏—Ä–∞–µ–º —Ç–æ—á–∫–∏ –ø–æ—Å–ª–µ "–æ–±–ª", "–≥" –∏ —Ç.–¥.
    normalized = re.sub(r'\b(–æ–±–ª|–≥|—Ä–µ—Å–ø|–∫—Ä–∞–π|–∞–≤—Ç|–æ–∫—Ä|–∞–æ)\b\.?', r'\1', normalized)
    return normalized


def find_region(region_input: str, threshold: float = 0.6) -> Optional[str]:
    """
    –ü–æ–∏—Å–∫ —Ä–µ–≥–∏–æ–Ω–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º fuzzy matching.

    Args:
        region_input: –í—Ö–æ–¥–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
        threshold: –ü–æ—Ä–æ–≥ —Å—Ö–æ–∂–µ—Å—Ç–∏ (0-1)

    Returns:
        –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ –∏–ª–∏ None –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
    """
    normalized_input = normalize_region_name(region_input)

    # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (lowercase)
    for region in ALL_REGIONS:
        if normalize_region_name(region) == normalized_input:
            return region

    # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–ª–∏–∞—Å—ã
    if normalized_input in ALIAS_TO_REGION:
        official_name = ALIAS_TO_REGION[normalized_input]
        # –ù–∞—Ö–æ–¥–∏–º —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
        for region in ALL_REGIONS:
            if normalize_region_name(region) == official_name:
                return region

    # 3. Fuzzy matching –ø–æ –≤—Å–µ–º —Ä–µ–≥–∏–æ–Ω–∞–º
    all_regions_lower = [r.lower() for r in ALL_REGIONS]
    matches = get_close_matches(normalized_input, all_regions_lower, n=1, cutoff=threshold)

    if matches:
        # –ù–∞—Ö–æ–¥–∏–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (—Å –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏)
        matched_lower = matches[0]
        for region in ALL_REGIONS:
            if region.lower() == matched_lower:
                return region

    return None


def parse_regions_input(regions_text: str) -> List[str]:
    """
    –ü–∞—Ä—Å–∏–Ω–≥ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é —Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º.

    Args:
        regions_text: –¢–µ–∫—Å—Ç —Å —Ä–µ–≥–∏–æ–Ω–∞–º–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é

    Returns:
        –°–ø–∏—Å–æ–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π —Ä–µ–≥–∏–æ–Ω–æ–≤
    """
    if not regions_text or not regions_text.strip():
        return [], []

    # –†–∞–∑–±–∏–≤–∞–µ–º –ø–æ –∑–∞–ø—è—Ç–æ–π
    region_inputs = [r.strip() for r in regions_text.split(',') if r.strip()]

    recognized_regions = []
    unrecognized = []

    for region_input in region_inputs:
        recognized = find_region(region_input)
        if recognized:
            recognized_regions.append(recognized)
        else:
            unrecognized.append(region_input)

    return recognized_regions, unrecognized


def get_regions_by_district(district_name: str) -> List[str]:
    """
    –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞.

    Args:
        district_name: –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞

    Returns:
        –°–ø–∏—Å–æ–∫ —Ä–µ–≥–∏–æ–Ω–æ–≤
    """
    district_data = FEDERAL_DISTRICTS.get(district_name)
    if district_data:
        return district_data["regions"]
    return []


def get_district_by_region(region_name: str) -> Optional[str]:
    """
    –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ä–µ–≥–∏–æ–Ω–∞.

    Args:
        region_name: –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞

    Returns:
        –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞ –∏–ª–∏ None
    """
    return REGION_TO_DISTRICT.get(region_name.lower())


def get_all_federal_districts() -> List[Dict[str, any]]:
    """
    –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –æ–∫—Ä—É–≥–æ–≤.

    Returns:
        –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏ –§–û
    """
    return [
        {
            "name": name,
            "code": data["code"],
            "regions_count": len(data["regions"])
        }
        for name, data in FEDERAL_DISTRICTS.items()
    ]


def format_regions_list(regions: List[str], max_display: int = 5) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.

    Args:
        regions: –°–ø–∏—Å–æ–∫ —Ä–µ–≥–∏–æ–Ω–æ–≤
        max_display: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
    """
    if not regions:
        return "–ù–µ —É–∫–∞–∑–∞–Ω—ã"

    if len(regions) <= max_display:
        return ", ".join(regions)
    else:
        displayed = regions[:max_display]
        remaining = len(regions) - max_display
        return f"{', '.join(displayed)} –∏ –µ—â–µ {remaining}"


# ============================================
# –¢–ï–°–¢–´ (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏)
# ============================================

if __name__ == "__main__":
    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è regions.py\n")

    # –¢–µ—Å—Ç 1: –ü–æ–∏—Å–∫ —Ä–µ–≥–∏–æ–Ω–æ–≤
    test_inputs = [
        "–º–æ—Å–∫–≤–∞",
        "–ú–°–ö",
        "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
        "—Å–ø–±",
        "–º–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª",
        "–ù–∏–∂–Ω–∏–π –Ω–æ–≤–≥–æ—Ä–æ–¥",
        "–∫—Ä–∞—Å–Ω–æ–¥–∞—Ä",
        "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥",
        "Invalid Region"
    ]

    print("1. –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤:")
    for test_input in test_inputs:
        result = find_region(test_input)
        status = "‚úÖ" if result else "‚ùå"
        print(f"  {status} '{test_input}' ‚Üí {result}")

    # –¢–µ—Å—Ç 2: –ü–∞—Ä—Å–∏–Ω–≥ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤
    print("\n2. –¢–µ—Å—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤:")
    test_multi = "–º–æ—Å–∫–≤–∞, —Å–ø–±, –∫—Ä–∞—Å–Ω–æ–¥–∞—Ä, –Ω–∏–∂–Ω–∏–π –Ω–æ–≤–≥–æ—Ä–æ–¥, Invalid"
    recognized, unrecognized = parse_regions_input(test_multi)
    print(f"  –í–≤–æ–¥: {test_multi}")
    print(f"  ‚úÖ –†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ ({len(recognized)}): {recognized}")
    print(f"  ‚ùå –ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ ({len(unrecognized)}): {unrecognized}")

    # –¢–µ—Å—Ç 3: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–æ–≤ –§–û
    print("\n3. –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–æ–≤ –§–û:")
    central_regions = get_regions_by_district("–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π")
    print(f"  –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –§–û: {len(central_regions)} —Ä–µ–≥–∏–æ–Ω–æ–≤")
    print(f"  –ü–µ—Ä–≤—ã–µ 5: {central_regions[:5]}")

    # –¢–µ—Å—Ç 4: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –§–û –ø–æ —Ä–µ–≥–∏–æ–Ω—É
    print("\n4. –¢–µ—Å—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –§–û –ø–æ —Ä–µ–≥–∏–æ–Ω—É:")
    test_regions = ["–ú–æ—Å–∫–≤–∞", "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥", "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π"]
    for region in test_regions:
        district = get_district_by_region(region)
        print(f"  {region} ‚Üí {district}")

    print("\n‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã!")
