# 🚀 Быстрый деплой V2.0 на сервер

## Что нужно сделать (2 команды!)

### 1️⃣ Подключиться к серверу где работает бот

Способ зависит от того, как у тебя настроен доступ:

**Вариант A: Если есть SSH доступ**
```bash
ssh user@your-server.com
cd /path/to/tender-ai-bot
```

**Вариант B: Если сервер на VPS (DigitalOcean, AWS и т.д.)**
- Зайти в панель управления
- Открыть консоль сервера
- Перейти в папку проекта: `cd /path/to/tender-ai-bot`

**Вариант C: Если не знаешь где сервер**
- Напиши мне, я помогу найти

---

### 2️⃣ Запустить автоматический деплой

```bash
# Скачать обновления
git pull origin main

# Запустить деплой
./deploy.sh
```

**ВСЁ!** Скрипт автоматически:
- ✅ Остановит бота
- ✅ Сделает бэкап базы данных
- ✅ Обновит код до V2.0
- ✅ Пересоберет Docker контейнер
- ✅ Запустит бота снова
- ✅ Проверит что всё работает

---

## 📺 Что ты увидишь

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  🚀 ДЕПЛОЙ TENDER-AI-BOT V2.0
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📊 Шаг 1/6: Проверка текущего состояния...
✓ Контейнер tender-ai-bot работает
Текущий коммит: a676c93 🎨 Improve bot buttons

💾 Шаг 2/6: Создание бэкапа базы данных...
✓ Бэкап создан: bot/database/tender_bot.db.backup_20241124_170000

🛑 Шаг 3/6: Остановка контейнера...
✓ Контейнер остановлен
⏳ Ожидание 10 секунд...

📥 Шаг 4/6: Обновление кода из GitHub...
Будут применены следующие изменения:
82f4357 🚀 Add automated deployment script
c83fd9a 📝 Add V2.0 deployment instructions
b305511 🚀 V2.0: Major Modernization

Продолжить обновление? [y/N]: y
✓ Код обновлен: 82f4357 🚀 Add automated deployment script

🔨 Шаг 5/6: Пересборка Docker образа...
✓ Образ пересобран

🚀 Шаг 6/6: Запуск контейнера...
✓ Контейнер запущен: Up 15 seconds (healthy)

📝 Последние 20 строк логов:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ База данных инициализирована
✅ Бот успешно запущен!
Start polling
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✓ Ошибок в логах не обнаружено

🗄️  Проверка базы данных...
✓ Таблица tender_analyses создана
  Записей в кэше: 0

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  ✅ ДЕПЛОЙ ЗАВЕРШЕН УСПЕШНО!
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎉 Бот обновлен до V2.0 и готов к использованию!
```

---

## ❓ Если что-то пошло не так

### Проблема: "permission denied"
```bash
chmod +x deploy.sh
./deploy.sh
```

### Проблема: "git pull conflicts"
```bash
git stash  # Сохранить локальные изменения
git pull origin main
./deploy.sh
```

### Проблема: "docker command not found"
Возможно бот запущен БЕЗ Docker. В этом случае:
```bash
# 1. Остановить бота
pkill -f "python.*bot.main"

# 2. Обновить код
git pull origin main

# 3. Запустить бота
python3 -m bot.main &
```

---

## 🧪 Как проверить что V2.0 работает

### Тест 1: Проверка логов
```bash
docker-compose logs -f
```
Должны видеть: `✅ База данных инициализирована`

### Тест 2: Проверка таблицы
```bash
docker-compose exec tender-bot sqlite3 /app/bot/database/tender_bot.db ".tables"
```
Должна быть таблица: `tender_analyses`

### Тест 3: В Telegram боте
1. Открыть бота
2. Найти тендер
3. Проанализировать его (займет ~60 сек)
4. **Анализировать тот же тендер еще раз**
5. Должно быть **МГНОВЕННО** (из кэша!)

---

## 📞 Нужна помощь?

Если застрял на любом шаге - просто напиши мне:
- Где застрял
- Какую ошибку видишь
- Скриншот если есть

Я сразу помогу разобраться! 🚀
